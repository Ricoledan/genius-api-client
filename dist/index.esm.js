import e from"axios";import t from"fs";import n from"path";function s(e){console.log("[dotenv][DEBUG] "+e)}const a=/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/,r=/\\n/g,o=/\n|\r|\r\n/;(function(e){let i=n.resolve(process.cwd(),".env"),l="utf8",p=!1;e&&(null!=e.path&&(i=e.path),null!=e.encoding&&(l=e.encoding),null!=e.debug&&(p=!0));try{const e=function(e,t){const n=!(!t||!t.debug),i={};return e.toString().split(o).forEach((function(e,t){const o=e.match(a);if(null!=o){const e=o[1];let t=o[2]||"";const n=t.length-1,s='"'===t[0]&&'"'===t[n];"'"===t[0]&&"'"===t[n]||s?(t=t.substring(1,n),s&&(t=t.replace(r,"\n"))):t=t.trim(),i[e]=t}else n&&s(`did not match key and value when parsing line ${t+1}: ${e}`)})),i}(t.readFileSync(i,{encoding:l}),{debug:p});Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(process.env,t)?p&&s(`"${t}" is already defined in \`process.env\` and will not be overwritten`):process.env[t]=e[t]}))}catch(e){return{error:e}}})();const i=e.create({method:"GET",baseURL:"https://api.genius.com/",headers:{Authorization:"Bearer "+process.env.ACCESS_TOKEN,"content-type":"application/json",useQueryString:!0},data:{code:"",client_id:process.env.CLIENT_ID,client_secret:process.env.CLIENT_SECRET,response_type:"code",grant_type:"authorization_code"}});function l(e){let t;const n=[];for(t=0;t<e.length;t++)n.push({song_id:e[t].result.id,full_song_title:e[t].result.title_with_featured,song_title:e[t].result.title,song_art_image_thumbnail:e[t].result.song_art_image_thumbnail_url,song_art_image_url:e[t].result.song_art_image_url});return n}const p=e=>i({url:"search",params:{q:""+e,text_format:"plain"}}).then(e=>({id:e.data.response.hits[0].result.primary_artist.id+"",songs:l(e.data.response.hits)})).catch(e=>{e.response}),c=e=>{i({url:"/artists/"+e,params:{text_format:"plain"}}).then(e=>({bio:e.data.response.artist.description.plain,alias:e.data.response.artist.alternate_names,social_media:{facebook:e.data.response.artist.facebook_name,instagram:e.data.response.artist.instagram_name,twitter:e.data.response.artist.twitter_name}})).catch(e=>{e.response})},u=e=>{i({url:"/songs/"+e,params:{text_format:"plain"}}).then(e=>({title:e.data.response.song.full_title,apple_id:e.data.response.song.apple_music_id,apple_player:e.data.response.song.apple_music_player_url,description:e.data.response.song.description.plain,album:e.data.response.song.album.name})).catch(e=>{e.response})};export{c as getArtistDetails,p as getArtistIdDetails,u as getSongDetails};
